<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>紫金财富金融服务平台</title>
<meta name="keywords" content="紫金财富金融服务平台"/>
<meta name="description" content="紫金财富金融服务平台"/>
<link href="${b.staticPath}style/style.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="${b.staticPath}js/datepicker.css">
<script src="${b.staticPath}js/jquery.js" type="text/javascript"></script>
<script src="${b.staticPath}js/datepicker.js"></script>
<script src="${b.staticPath}js/datepicker.zh-CN.js"></script>
<script src="${b.staticPath}js/jquery.paginate.js"></script>
<@b.pageScript/>
<@b.dialogBox/>
<@b.validate/>
<script>
function query(page){
	var params=$("#search_form").serialize();
	//alert(params);
	 if(page!=undefined){
		   params=params+"&currentPage="+page;
	   }
	 $.post("${basePath}customer/query.htm",params,function(data){
		var res=$(data).find("#main_div");
		var pager=$(data).find("#pager");
		$("#main_div").empty();
		$("#main_div").append(res.html());
		var totalPage=pager.attr("totalPage");
		var currentPage=pager.attr("currentPage");
		loadPage(currentPage,totalPage,query);
	});
}
function to_add(){
	 $.get("${basePath}customer/toAdd.htm",function(data){
			var res=$(data).find(".ly-left");
			var pager=$(data).find("#pager");
			$("#main_div").empty();
			$("#main_div").append($(data).html());
		});
}
function selectArea(){
	var province=$("#province_select").val();
	 $("#provinceName").val($("#province_select").text());
	 $.get("${basePath}customer/queryArea.htm?parentId="+province,function(data){
		 if(data.isOK==true){
			$.each(data.areaList, function(i, n){
				$("#city_select").append("<option value='"+n.id+"'>"+n.name+"</option>");
			});
			$("#city_select").show();
		 }
		});
}
function selectCity(){
	var cityname=$("#city_select").text();
	 $("#provinceName").val($("#province_select").text());
}
function addCustomer(){
	var params=$("#addForm").serialize();
	 dialogBox(function(index){
		 $.post("${basePath}customer/add.htm",params,function(data){
			    layer.close(index);
				if(data.isOK==true){
					succInfo(function(){
						 query();
					 },"添加成功");
				}
				else{
					errorInfo(data.error);
				}
		});
	   },"是否确认添加客户");
}
</script>
</head>

<body>
<@b.header/>
<div class="fence">
  <div class="fence-wide pt10 pb10 ly-clearFix">
    <@b.leftMenu/>
    <div id="main_div" class="yard-1100 ly-left">
      <div class="rightSide">
        <div class="heading fontYH f20">客户管理</div>
        <div class="mainBox">
        <form action="javascript:void(0);" id="search_form">
          <div class="searBox f12 mt10 mb10">
            <p>客户ID
              <input class="input" type="text" name="customerId" value="${query.customerId}" />
              姓名
              <input class="input" type="text" name="name" value="${query.name}" />
              手机号
              <input type="text" class="input" name="phone" value="${query.phone}" />
              金融产品
              <input type="text" class="input" name="productId" value="${query.productId}" />
              客户来源
              <input type="text" class="input" name="channelId" value="${query.channelId}" />
              客户分级
              <select name="level" id="select4">
              <option value="">-请选择--</option>
              <#list levels as levels>
              <#if levels.id==query.level>
               <option value="${levels.getId()}" selected="selected">${levels.getName()}</option>
               <#else>
                <option value="${levels.getId()}">${levels.getName()}</option>
              </#if>
              </#list>
              </select>
            </p>
            <p> 录入时间段
              <input type="text" class="input input-time cal form-control" name="startDate" value="${query.startDate}" datepicker id="time1" />
              -
              <input type="text" class="input input-time cal form-control" name="endDate" value="${query.endDate}" datepicker id="time2"/>
              <span class="advanced" style="display:;"> 归属员工
              <input type="text" class="input" name="employeId" value="${query.employeId}" />
              UnionID
              <input type="text" class="input" name="unionId" value="${query.unionId}" />
              </span> <span class="btnBox">
              <button class="button button-search" onclick="query();">查询</button>
              </span> <span class="btnBox">
              <button class="button button-purple f12" onclick="to_add();">新增客户</button>
              </span> </p>
          </div>
          </form>
          <table id="res_table" border="0" cellspacing="0" cellpadding="0" class="tabList mb10">
            <col width="5%" />
            <col width="5%" />
            <col width="10%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="10%" />
            <col width="10%" />
            <col width="10%" />
            <col width="11%" />
            <col width="15%" />
            <tr>
              <th>ID</th>
              <th>姓名</th>
              <th>手机号</th>
              <th>归属员工</th>
              <th>投资明细</th>
              <th>客户来源</th>
              <th>分级</th>
              <th>跟踪记录</th>
              <th>UnionID</th>
              <th>录入时间</th>
              <th>管理</th>
            </tr>
            <#list list as model>
            <tr class="bColor-red" title="有报名未处理的客户记录">
              <td><a href="#">${model.customerId}</a></td>
              <td>${model.customerId}</td>
              <td>${model.phone}</td>
              <td>${model.name}</td>
              <td><a href="#">查询明细</a></td>
              <td>${model.channelId}</td>
              <td><a href="#" class="levinput">${model.level.getName()}</a></td>
              <td><a href="#">管理记录</a></td>
              <td title="${model.unionId}" class="color-orange">查看</td>
              <td>2015-01-31</td>
              <td class="edit"><a href="#" class="del">删除</a> <a href="#" class="allot memberBox meminput">分配</a></td>
            </tr>
            </#list>
          </table>
		 <@b.pager/>
        </div>
      </div>
    </div>
  </div>
</div>
<@b.footer/>
<div class="modal-wrap popDemo remList" style="display:none;">
      <div class="modal-header"><span class="close">关闭</span></div>
     <div class="modal-body memberBox" title="优先显示通过UnionID匹配到的员工编号，如果没有的情况下显示UnionID">
       <div class="item fontYH color-blue">第一度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第二度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第三度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第四度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第五度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
  </div>
  </div>
<div class="modal-wrap popDemo memLevel" style="display:none;">
  <div class="modal-header"><span class="close">关闭</span></div>
  <div class="modal-body memberBox">
    <div class="item fontYH color-blue">客户分级 :
      <select name="select4" id="select4" class="fontYH">
                <option>新客户</option>
                <option>准客户</option>
                <option>大客户</option>
                <option>VIP客户</option>
              </select>
    </div>
    <button class="popBtn">确认</button>
  </div>
</div>
<div class="modal-wrap popDemo memberList" style="display:none;">
      <div class="modal-header"><span class="close">关闭</span></div>
     <div class="modal-body memberBox">
       <div class="item fontYH color-blue">
         归属员工 :<input name="" type="text" class="input input-w220h30 ml5 fontYH" title="联想输入员工编号" value="请输入员工编号" /> </div>
  <button class="popBtn">确认</button></div>
  </div>
</body>
</html>
